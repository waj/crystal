require "../safe_int_spec_helper"

# Ported from https://github.com/dcleblanc/SafeInt/blob/3.23/Test/AddVerify.cpp#L4696-L4784
run_add_tests UInt8, UInt8, [
  {0x00, 0x00, true},
  {0x01, 0x00, true},
  {0x02, 0x00, true},
  {0x7e, 0x00, true},
  {0x7f, 0x00, true},
  {0x80, 0x00, true},
  {0x81, 0x00, true},
  {0xfe, 0x00, true},
  {0xff, 0x00, true},

  {0x00, 0x01, true},
  {0x01, 0x01, true},
  {0x02, 0x01, true},
  {0x7e, 0x01, true},
  {0x7f, 0x01, true},
  {0x80, 0x01, true},
  {0x81, 0x01, true},
  {0xfe, 0x01, true},
  {0xff, 0x01, false},

  {0x00, 0x02, true},
  {0x01, 0x02, true},
  {0x02, 0x02, true},
  {0x7e, 0x02, true},
  {0x7f, 0x02, true},
  {0x80, 0x02, true},
  {0x81, 0x02, true},
  {0xfe, 0x02, false},
  {0xff, 0x02, false},

  {0x00, 0x7e, true},
  {0x01, 0x7e, true},
  {0x02, 0x7e, true},
  {0x7e, 0x7e, true},
  {0x7f, 0x7e, true},
  {0x80, 0x7e, true},
  {0x81, 0x7e, true},
  {0xfe, 0x7e, false},
  {0xff, 0x7e, false},

  {0x00, 0x7f, true},
  {0x01, 0x7f, true},
  {0x02, 0x7f, true},
  {0x7e, 0x7f, true},
  {0x7f, 0x7f, true},
  {0x80, 0x7f, true},
  {0x81, 0x7f, false},
  {0xfe, 0x7f, false},
  {0xff, 0x7f, false},

  {0x00, 0x80, true},
  {0x01, 0x80, true},
  {0x02, 0x80, true},
  {0x7e, 0x80, true},
  {0x7f, 0x80, true},
  {0x80, 0x80, false},
  {0x81, 0x80, false},
  {0xfe, 0x80, false},
  {0xff, 0x80, false},

  {0x00, 0x81, true},
  {0x01, 0x81, true},
  {0x02, 0x81, true},
  {0x7e, 0x81, true},
  {0x7f, 0x81, false},
  {0x80, 0x81, false},
  {0x81, 0x81, false},
  {0xfe, 0x81, false},
  {0xff, 0x81, false},

  {0x00, 0xfe, true},
  {0x01, 0xfe, true},
  {0x02, 0xfe, false},
  {0x7e, 0xfe, false},
  {0x7f, 0xfe, false},
  {0x80, 0xfe, false},
  {0x81, 0xfe, false},
  {0xfe, 0xfe, false},
  {0xff, 0xfe, false},

  {0x00, 0xff, true},
  {0x01, 0xff, false},
  {0x02, 0xff, false},
  {0x7e, 0xff, false},
  {0x7f, 0xff, false},
  {0x80, 0xff, false},
  {0x81, 0xff, false},
  {0xfe, 0xff, false},
  {0xff, 0xff, false},
]
